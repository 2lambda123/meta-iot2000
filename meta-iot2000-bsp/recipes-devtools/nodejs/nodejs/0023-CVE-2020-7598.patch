From f8196208517272db4a593805cbbab8c6ef2d44a6 Mon Sep 17 00:00:00 2001
From: Su Baocheng <baocheng.su@siemens.com>
Date: Wed, 21 Oct 2020 13:38:27 +0800
Subject: [PATCH 23/24] CVE-2020-7598

Ported from
OpenSUSE:nodejs8-8.17.0-lp152.147.1:minimist.patch

Signed-off-by: Su Baocheng <baocheng.su@siemens.com>
---
 deps/npm/node_modules/minimist/index.js                 | 1 +
 deps/npm/node_modules/rc/node_modules/minimist/index.js | 1 +
 2 files changed, 2 insertions(+)

diff --git a/deps/npm/node_modules/minimist/index.js b/deps/npm/node_modules/minimist/index.js
index 584f551a6d..39a7055b26 100644
--- a/deps/npm/node_modules/minimist/index.js
+++ b/deps/npm/node_modules/minimist/index.js
@@ -161,6 +161,7 @@ function setKey (obj, keys, value) {
     var o = obj;
     keys.slice(0,-1).forEach(function (key) {
         if (o[key] === undefined) o[key] = {};
+        if (o[key] === {}.__proto__) o[key] = {};
         o = o[key];
     });
     
diff --git a/deps/npm/node_modules/rc/node_modules/minimist/index.js b/deps/npm/node_modules/rc/node_modules/minimist/index.js
index 6a0559d581..f74d8b6242 100644
--- a/deps/npm/node_modules/rc/node_modules/minimist/index.js
+++ b/deps/npm/node_modules/rc/node_modules/minimist/index.js
@@ -70,6 +70,7 @@ module.exports = function (args, opts) {
         var o = obj;
         keys.slice(0,-1).forEach(function (key) {
             if (o[key] === undefined) o[key] = {};
+            if (o[key] === {}.__proto__) o[key] = {};
             o = o[key];
         });
 
-- 
2.25.1

